	protected void setUpProjectCompliance(IJavaProject javaProject, String compliance) throws JavaModelException, IOException {
		// Look for version to set and return if that's already done
		String version = CompilerOptions.VERSION_1_4;
		String jclLibString = null;
		String newJclLibString = null;
		String newJclSrcString = null;
		switch (compliance.charAt(2)) {
			case '5':
				version = CompilerOptions.VERSION_1_5;
				if (version.equals(javaProject.getOption(CompilerOptions.OPTION_Compliance, false))) {
					return;
				}
				jclLibString = "JCL_LIB";
				newJclLibString = "JCL15_LIB";
				newJclSrcString = "JCL15_SRC";
				break;
			case '3':
				version = CompilerOptions.VERSION_1_3;
			default:
				if (version.equals(javaProject.getOption(CompilerOptions.OPTION_Compliance, false))) {
					return;
				}
				jclLibString = "JCL15_LIB";
				newJclLibString = "JCL_LIB";
				newJclSrcString = "JCL_SRC";
				break;
		}
		
		// ensure variables are set
		setUpJCLClasspathVariables(compliance);
		
		// set options
		Map options = new HashMap();
		options.put(CompilerOptions.OPTION_Compliance, version);
		options.put(CompilerOptions.OPTION_Source, version);	
		options.put(CompilerOptions.OPTION_TargetPlatform, version);	
		javaProject.setOptions(options);
		
		// replace JCL_LIB with JCL15_LIB, and JCL_SRC with JCL15_SRC
		IClasspathEntry[] classpath = javaProject.getRawClasspath();
		IPath jclLib = new Path(jclLibString);
		for (int i = 0, length = classpath.length; i < length; i++) {
			IClasspathEntry entry = classpath[i];
			if (entry.getPath().equals(jclLib)) {
				classpath[i] = JavaCore.newVariableEntry(
						new Path(newJclLibString), 
						new Path(newJclSrcString), 
						entry.getSourceAttachmentRootPath(), 
						entry.getAccessRules(), 
						new IClasspathAttribute[0], 
						entry.isExported());
				break;
			}
		}
		javaProject.setRawClasspath(classpath, null);
	}

