/*
 * test for bug 32690
 * simulate checkout of project with invalid classpath
 */
public void testNestedSourceFolders() throws CoreException {
	try {
		final IProject project = getProject("P");
		
		project.create(null);
		project.open(null);
		
		try {
			File pro = project.getLocation().toFile();
			File src = ClasspathTests.this.createFolder(pro, "src");
			ClasspathTests.this.createFolder(src, "src2");
			
			ClasspathTests.this.createFile(pro, ".project", 
				"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
				"<projectDescription>\n" +
				"	<name>org.eclipse.jdt.core</name>\n" +
				"	<comment></comment>\n" +
				"	<projects>\n" +
				"	</projects>\n" +
				"	<buildSpec>\n" +
				"		<buildCommand>\n" +
				"			<name>org.eclipse.jdt.core.javabuilder</name>\n" +
				"			<arguments>\n" +
				"			</arguments>\n" +
				"		</buildCommand>\n" +
				"	</buildSpec>\n" +
				"	<natures>\n" +
				"		<nature>org.eclipse.jdt.core.javanature</nature>\n" +
				"	</natures>\n" +
				"</projectDescription>");


			ClasspathTests.this.createFile(pro, ".classpath",
				"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
				"<classpath>\n" +
				"    <classpathentry kind=\"src\" path=\"src\"/>\n" +
				"    <classpathentry kind=\"src\" path=\"src/src2\"/>\n" +
				"    <classpathentry kind=\"output\" path=\"bin\"/>\n" +
				"</classpath>"
			);
		} catch (IOException e) {
			assertTrue(e.getMessage(), false);
		}
		project.refreshLocal(IResource.DEPTH_INFINITE,null);
		this.assertMarkers(
			"Unexpected markers",
			"Cannot nest 'P/src/src2' inside 'P/src'. To enable the nesting exclude 'src2/' from 'P/src'",
			JavaCore.create(project));
	} finally {
		this.deleteProject("P");
	}
}

